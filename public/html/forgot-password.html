

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Forgot Password</title>
  <link rel="stylesheet" href="/css/login-style.css" />
</head>
<body>
    <main class="main flow">
        <div class="main__cards cards">
            <div class="cards__inner">
                <div class="cards__card card">
                    <h1 class="card__heading">FORGOT PASSWORD</h1>
                    <p class="ca_c">
                        Enter your email below and we'll send you an OTP.
                    </p>
                    <p id="message" style="text-align: center; margin-top: 10px;"></p>
                    <form onsubmit="requestOTP(event)">
                        <div class="field">
                            <input
                                type="email"
                                id="account-login-email"
                                autocorrect="off"
                                autocapitalize="none"
                                autocomplete="on"
                                placeholder="EMAIL"
                                required
                            />
                        </div>
                        <a href="javascript:void(0);" class="card__cta cta" onclick="requestOTP(event)">SEND OTP</a>
                    </form>
                </div>
                <div class="cards__card card">
                    <h1 class="card__heading">CREATE ACCOUNT</h1>
                    <p class="ca_c">
                        Sign up now to start sharing your thoughts, posting updates, and
                        anonymously engaging with your college peers.
                    </p>
                    <a href="/register" class="card__cta cta">CREATE ACCOUNT</a>
                </div>
            </div>
            <div class="overlay cards__inner"></div>
        </div>
    </main>

    <script>
      async function requestOTP(event) {
          event.preventDefault();

          const email = document.getElementById("account-login-email").value;
          const message = document.getElementById("message");

          if (!email) {
              message.textContent = "Please enter your email.";
              message.style.color = "red";
              return;
          }

          const response = await fetch("/forgot-password", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ email_id: email })
          });

          const result = await response.json();
          message.textContent = result.message;

          if (response.ok) {
              message.style.color = "green";
              setTimeout(() => {
                window.location.href = `/html/otp-verification.html?email=${encodeURIComponent(email)}`;
              }, 1500);
          } else {
              message.style.color = "red";
          }
      }
  </script>

</body>
</html>

