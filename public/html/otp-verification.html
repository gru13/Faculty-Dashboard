<!DOCTYPE html>
<html lang="en">
<head>
  <title>OTP Verification</title>
  <link rel="stylesheet" href="/css/login-style.css" />
</head>
<body>
    <nav>
    <div class="menu">
      <p></p>
      <svg width="313" height="50" viewBox="0 0 313 92" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0.40625 17.7344H65.9375V30.7656H15.2656V49.9375H58.2969V62.1719H15.2656V91H0.40625V17.7344ZM68.2419 73.5625C68.2419 70.9062 68.82 68.4844 69.9762 66.2969C71.1325 64.1094 72.8669 62.2344 75.1794 60.6719C77.4919 59.0781 80.3669 57.8594 83.8044 57.0156C87.2731 56.1406 91.3044 55.7031 95.8981 55.7031C99.3044 55.7031 102.882 55.9531 106.632 56.4531C110.414 56.9531 114.304 57.7188 118.304 58.75C118.148 57 117.617 55.3906 116.711 53.9219C115.804 52.4219 114.539 51.1406 112.914 50.0781C111.32 48.9844 109.382 48.1406 107.101 47.5469C104.851 46.9531 102.289 46.6562 99.4137 46.6562C97.8512 46.6562 96.1325 46.75 94.2575 46.9375C92.3825 47.125 90.445 47.4062 88.445 47.7812C86.445 48.1562 84.4606 48.625 82.4919 49.1875C80.5544 49.75 78.7419 50.4219 77.0544 51.2031L72.8356 39.8125C74.9294 39.0625 77.1637 38.375 79.5387 37.75C81.945 37.125 84.3981 36.5938 86.8981 36.1562C89.3981 35.6875 91.8981 35.3281 94.3981 35.0781C96.8981 34.8281 99.32 34.7031 101.664 34.7031C112.007 34.7031 119.695 37.3438 124.726 42.625C129.757 47.9062 132.273 56 132.273 66.9062V91H118.398V85.7969C116.961 86.6406 115.382 87.4375 113.664 88.1875C111.976 88.9375 110.132 89.5938 108.132 90.1562C106.132 90.7188 103.976 91.1562 101.664 91.4688C99.3825 91.8125 96.9606 91.9844 94.3981 91.9844C90.0856 91.9844 86.2887 91.5156 83.0075 90.5781C79.7575 89.6406 77.0387 88.3438 74.8512 86.6875C72.6637 85.0312 71.0075 83.0938 69.8825 80.875C68.7887 78.625 68.2419 76.1875 68.2419 73.5625ZM82.8669 73.0938C82.8669 74 83.1012 74.875 83.57 75.7188C84.0387 76.5312 84.7887 77.2656 85.82 77.9219C86.8512 78.5469 88.1637 79.0625 89.7575 79.4688C91.3825 79.8438 93.3356 80.0312 95.6169 80.0312C98.0544 80.0312 100.414 79.8125 102.695 79.375C104.976 78.9375 107.101 78.3594 109.07 77.6406C111.039 76.9219 112.82 76.0938 114.414 75.1562C116.007 74.2188 117.336 73.25 118.398 72.25V69.8125C116.273 69.2188 114.164 68.7188 112.07 68.3125C110.007 67.9062 108.023 67.5938 106.117 67.375C104.242 67.125 102.461 66.9531 100.773 66.8594C99.1169 66.7656 97.6637 66.7188 96.4137 66.7188C93.82 66.7188 91.6637 66.8906 89.945 67.2344C88.2262 67.5781 86.8356 68.0469 85.7731 68.6406C84.7106 69.2031 83.9606 69.875 83.5231 70.6562C83.0856 71.4375 82.8669 72.25 82.8669 73.0938ZM145.171 74.0312C148.921 76.2812 153.046 77.9375 157.546 79C162.046 80.0625 166.656 80.5938 171.374 80.5938C174.562 80.5938 177.218 80.375 179.343 79.9375C181.468 79.5 183.171 78.9375 184.452 78.25C185.734 77.5625 186.64 76.7812 187.171 75.9062C187.702 75.0312 187.968 74.1406 187.968 73.2344C187.968 71.9219 187.39 70.7969 186.234 69.8594C185.109 68.9219 183.234 68.4531 180.609 68.4531C179.39 68.4531 178.077 68.5312 176.671 68.6875C175.265 68.8438 173.781 69.0156 172.218 69.2031C170.687 69.3594 169.077 69.5156 167.39 69.6719C165.734 69.8281 164.046 69.9062 162.327 69.9062C158.577 69.9062 155.374 69.5 152.718 68.6875C150.093 67.875 147.952 66.7656 146.296 65.3594C144.64 63.9531 143.437 62.2969 142.687 60.3906C141.937 58.4531 141.562 56.375 141.562 54.1562C141.562 51.3438 142.218 48.75 143.531 46.375C144.843 44 146.718 41.9531 149.156 40.2344C151.593 38.4844 154.531 37.125 157.968 36.1562C161.437 35.1875 165.296 34.7031 169.546 34.7031C171.765 34.7031 174.077 34.8438 176.484 35.125C178.921 35.375 181.312 35.7188 183.656 36.1562C185.999 36.5938 188.249 37.1094 190.406 37.7031C192.562 38.2656 194.468 38.875 196.124 39.5312L191.765 50.3125C188.234 49 184.702 47.9688 181.171 47.2188C177.671 46.4375 174.062 46.0469 170.343 46.0469C167.749 46.0469 165.546 46.25 163.734 46.6562C161.952 47.0312 160.499 47.5469 159.374 48.2031C158.249 48.8281 157.421 49.5625 156.89 50.4062C156.39 51.2188 156.14 52.0781 156.14 52.9844C156.14 53.6406 156.265 54.2344 156.515 54.7656C156.796 55.2969 157.234 55.7656 157.827 56.1719C158.452 56.5469 159.249 56.8438 160.218 57.0625C161.218 57.25 162.437 57.3438 163.874 57.3438C165.187 57.3438 166.577 57.2656 168.046 57.1094C169.515 56.9531 171.046 56.7969 172.64 56.6406C174.234 56.4531 175.874 56.2812 177.562 56.125C179.281 55.9688 181.031 55.8906 182.812 55.8906C186.124 55.8906 189.015 56.2812 191.484 57.0625C193.984 57.8438 196.046 58.9375 197.671 60.3438C199.296 61.75 200.515 63.4062 201.327 65.3125C202.14 67.2188 202.546 69.2969 202.546 71.5469C202.546 74.4531 201.874 77.1562 200.531 79.6562C199.187 82.1562 197.187 84.3281 194.531 86.1719C191.874 87.9844 188.562 89.4062 184.593 90.4375C180.656 91.4688 176.093 91.9844 170.906 91.9844C167.718 91.9844 164.64 91.7812 161.671 91.375C158.702 91 155.874 90.4844 153.187 89.8281C150.499 89.1406 147.968 88.3438 145.593 87.4375C143.249 86.5312 141.109 85.5625 139.171 84.5312L145.171 74.0312ZM207.382 13.2812H221.257V39.9062C224.163 38.3125 227.398 37.0469 230.96 36.1094C234.554 35.1719 238.319 34.7031 242.257 34.7031C246.819 34.7031 250.913 35.375 254.538 36.7188C258.194 38.0625 261.288 40 263.819 42.5312C266.351 45.0312 268.288 48.0781 269.632 51.6719C271.007 55.2656 271.694 59.3125 271.694 63.8125V91H257.866V64.375C257.866 61.75 257.444 59.3594 256.601 57.2031C255.757 55.0156 254.523 53.1406 252.898 51.5781C251.273 50.0156 249.288 48.8125 246.944 47.9688C244.632 47.0938 242.007 46.6562 239.069 46.6562C235.538 46.6562 232.257 47.2188 229.226 48.3438C226.194 49.4688 223.538 50.8906 221.257 52.6094V91H207.382V13.2812Z" fill="#2C2C2C"/>
                <path d="M282.25 0C282.25 12.3951 271.567 22.75 258 22.75V29.25C274.809 29.25 288.75 16.3237 288.75 0H282.25ZM313 22.75C299.433 22.75 288.75 12.3951 288.75 0H282.25C282.25 16.3237 296.191 29.25 313 29.25V22.75ZM288.75 52C288.75 39.6049 299.433 29.25 313 29.25V22.75C296.191 22.75 282.25 35.6763 282.25 52H288.75ZM258 29.25C271.567 29.25 282.25 39.6049 282.25 52H288.75C288.75 35.6763 274.809 22.75 258 22.75V29.25Z" fill="url(#paint0_linear_0_1)"/>
                <line x1="261.962" y1="25.763" x2="72.9568" y2="23.2497" stroke="url(#paint1_linear_0_1)" stroke-width="6.5"/>
                <defs>
                <linearGradient id="paint0_linear_0_1" x1="264.699" y1="26" x2="312.712" y2="26" gradientUnits="userSpaceOnUse">
                <stop stop-color="#5571FD"/>
                <stop offset="1" stop-color="#88558F"/>
                </linearGradient>
                <linearGradient id="paint1_linear_0_1" x1="73.0066" y1="19.5" x2="262.012" y2="22.0133" gradientUnits="userSpaceOnUse">
                <stop stop-color="#2FFFC4"/>
                <stop offset="0.69" stop-color="#3078FF"/>
                <stop offset="1" stop-color="#6D6FFE"/>
                </linearGradient>
                </defs>
    </svg>
  <p></p>
    </div>
    <div class="backdop"></div>
  </nav>
 
  <canvas id="particleCanvas"></canvas>
    <main class="main flow">
        <div class="main__cards cards">
            <div class="cards__inner">
                <div class="cards__card card">
                    <h1 class="card__heading">VERIFY OTP</h1>
                    <p class="ca_c">
                        Enter the OTP sent to your email and reset your password.
                    </p>
                    <form onsubmit="verifyOTP(event)">
                        <input type="hidden" id="email" />
                        <div class="field">
                            <input
                                type="text"
                                id="otp"
                                placeholder="ENTER OTP"
                                required
                            />
                        </div>
                        <div class="field">
                            <input
                                type="password"
                                id="new-password"
                                placeholder="NEW PASSWORD"
                                required
                            />
                        </div>
                        <button type="submit" class="card__cta cta">RESET PASSWORD</button>
                    </form>
                    <p id="message" style="text-align: center; margin-top: 10px;"></p>
                </div>
            </div>
            <div class="overlay cards__inner"></div>
        </div>
    </main>

    <script>
        // Get email from URL params
        const urlParams = new URLSearchParams(window.location.search);
        document.getElementById("email").value = urlParams.get("email");

        async function verifyOTP(event) {
            event.preventDefault();

            const email = document.getElementById("email").value;
            const otp = document.getElementById("otp").value;
            const newPassword = document.getElementById("new-password").value;
            const message = document.getElementById("message");

            if (!otp || !newPassword) {
                message.textContent = "All fields are required.";
                message.style.color = "red";
                return;
            }

            const response = await fetch("/reset-password", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email_id: email, otp: otp, new_password: newPassword })
            });

            const result = await response.json();
            message.textContent = result.message;

            if (response.ok) {
                message.style.color = "green";
                setTimeout(() => {
                    window.location.href = "/"; // Redirect to login page
                }, 2000);
            } else {
                message.style.color = "red";
            }
        }
    </script>
</body>
</html>
